<h2>{{ isUserReservations ? 'My Reservations' : 'All Reservations' }}</h2>
<div class="filter-container">
  <div class="filter-row">
    <input
      type="text"
      [(ngModel)]="filters.bookTitle"
      (input)="applyFilter()"
      placeholder="Filter by book title..."
      class="filter-input"
    >
    <input
      type="text"
      [(ngModel)]="filters.bookAuthor"
      (input)="applyFilter()"
      placeholder="Filter by book author..."
      class="filter-input"
    >
    <input
      type="text"
      [(ngModel)]="filters.userName"
      (input)="applyFilter()"
      placeholder="Filter by user name..."
      class="filter-input"
    >
    <input
      type="text"
      [(ngModel)]="filters.status"
      (input)="applyFilter()"
      placeholder="Filter by status..."
      class="filter-input"
    >
    <input
      type="text"
      [(ngModel)]="filters.id"
      (input)="applyFilter()"
      placeholder="Filter by ID..."
      class="filter-input"
    >
  </div>
</div>
<table *ngIf="filteredReservations.length > 0; else noReservations">
  <thead>
  <tr>
    <th>ID</th>
    <th>Book</th>
    <th>User</th>
    <th>Status</th>
    <th>Reservation Date</th>
    <th>Return Date</th>
    <th>Actions</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let reservation of filteredReservations">
    <td>{{ reservation.reservation.id }}</td>
    <td>
      <div class="book-info">
        <div class="title">{{ reservation.book.title }}</div>
        <div class="author">{{ reservation.book.author }}</div>
      </div>
    </td>
    <td>
      <div class="user-info">
        <div class="name">{{ reservation.user.name }} {{ reservation.user.secondName }}</div>
        <div class="email">{{ reservation.user.email }}</div>
      </div>
    </td>
    <td>{{ reservation.reservation.status }}</td>
    <td>{{ reservation.reservation.createdDate | date:'dd.MM.yyyy HH:mm' }}</td>
    <td>{{ reservation.reservation.termDate | date:'dd.MM.yyyy HH:mm' }}</td>
    <td>
      <button *ngIf="canExtend(reservation)"
              (click)="extendReservation(reservation.reservation.id)"
              class="action-button extend">
        Extend
      </button>
      <button *ngIf="canCancel(reservation)"
              (click)="cancelReservation(reservation.reservation.id)"
              class="action-button cancel">
        Cancel
      </button>
      <button *ngIf="canIssue(reservation)"
              (click)="issueBook(reservation.reservation.id)"
              class="action-button issue">
        Issue
      </button>
      <button *ngIf="canComplete(reservation)"
              (click)="completeReservation(reservation.reservation.id)"
              class="action-button complete">
        Complete
      </button>
      <button *ngIf="canMarkAsLost(reservation)"
              (click)="markAsLost(reservation.reservation.id)"
              class="action-button lost">
        Mark as Lost
      </button>
    </td>
  </tr>
  </tbody>
</table>
<ng-template #noReservations>
  <p>No reservations found.</p>
</ng-template>

<div *ngIf="notification" class="notification" [ngStyle]="{ background: notification.color }">
  {{ notification.message }}
</div>
